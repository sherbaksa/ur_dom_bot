# Юридический чат-бот для консультаций по недвижимости

Telegram-бот с нейроассистентом для предоставления первичных юридических консультаций в сфере недвижимости. Анализирует вопросы пользователей, ищет ответы в базе знаний и при необходимости формирует развернутый ответ с использованием ИИ.

## Основные возможности
- Гибридная система ответов: поиск по базе знаний + генерация ответа через OpenAI
- Поддержка текстовых и голосовых сообщений
- Ответы со ссылками на действующее законодательство РФ
- Логирование запросов и ответов
- Полностью автоматизированная обработка вопросов

## Технологический стек

| Компонент | Назначение |
|-----------|------------|
| n8n (self-hosted) | Оркестрация процессов |
| Telegram Bot API | Взаимодействие с пользователями |
| OpenAI API | ChatGPT для генерации ответов, Whisper для транскрибации |
| Google Sheets API | База знаний и логирование |
| Python | Вспомогательные скрипты |

---

## Быстрый старт

### Требования
- VPS или локальный сервер (Ubuntu 20.04+ / Debian 11+)
- Telegram Bot Token
- OpenAI API Key
- Google Cloud Service Account

---

### Установка n8n

#### Вариант 1: через npm
```bash
npm install n8n -g
Вариант 2: через Docker
bash
Копировать код
docker run -it --rm \
  --name n8n \
  -p 5678:5678 \
  -v ~/.n8n:/home/node/.n8n \
  n8nio/n8n
```
### Настройка Telegram-бота
- Создать бота через @BotFather
- Получить API-токен
- Включить поддержку голосовых сообщений

### Настройка Google Sheets
- Создать таблицу
- Настроить Service Account в Google Cloud
- Предоставить доступ к таблице

### Импорт workflow в n8n
- Открыть интерфейс n8n: http://localhost:5678
- Импортировать основной workflow
- Настроить credentials

Переменные окружения
Создать файл .env:

### База знаний
База знаний хранится в локальной базе данных Qdrant. Загрузка дынных происходит при помощи скрипта faq_loader.py. Для его запуска, нужно в python-окружение установить необходимые модули:
pip install -r requirements.txt
описание загрузчика - в отдельном репозитории:

| Категория | Вопрос | Краткий ответ | Подробный ответ | Ссылки на законы | Ключевые слова |
|-----------|--------|---------------|-----------------|------------------|----------------|

Примерные категории:
Купля-продажа
Дарение
Наследование
Ипотека
Регистрация права собственности
Аренда
Спорные ситуации

### Системный промпт OpenAI

Ты юридический консультант по недвижимости. Отвечай на основе законодательства РФ. Делай ссылки на закон (статья, номер ФЗ). Формулируй ответы четко и структурировано. Если данных недостаточно — запроси уточнение. Если вопрос вне компетенции — предложи консультацию специалиста.

### Тестирование

```bash
python tests/test_bot_scenarios.py
python scripts/check_connections.py
```

#### Примеры запросов:

Как оформить договор купли-продажи квартиры?
Какие документы нужны для регистрации права собственности?
Какой налог при дарении недвижимости близкому родственнику?

#### Мониторинг и логирование
Отслеживание ошибок средствами n8n

#### Безопасность
Шифрование ключей в n8n Credentials
Анонимизация данных пользователей
Регулярные обновления и резервное копирование

### Развертывание в production
Рекомендуемая конфигурация:
2 CPU
4 GB RAM
SSD

#### Обязательные настройки:
HTTPS (через nginx reverse proxy)

Ограничение доступа к панели n8n
Пример Docker Compose
```yaml
version: '3.8'
services:
  n8n:
    image: n8nio/n8n
    restart: unless-stopped
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
    volumes:
      - n8n_data:/home/node/.n8n

volumes:
  n8n_data:
```
### Лицензия
Проект распространяется под лицензией MIT. См. файл LICENSE.
Вклад в проект
Сделайте форк
Создайте feature-ветку
Внесите изменения
Отправьте pull request

Поддержка
Issues в GitHub

Email: sherbaksa@gmail.com

#### Планы развития
Семантический поиск на основе векторных БД
Обработка PDF-документов
Мультиязычная поддержка
Панель администратора для управления базой знаний
Интеграции с другими мессенджерами

Последнее обновление: Декабрь 2025
